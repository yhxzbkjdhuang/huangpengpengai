# 语音输入功能使用指南 🎤

## 🎯 功能概述

语音输入功能让谢猪猪可以直接对黄鹏说话，系统会自动识别语音并转换为文字，然后发送给AI处理。

## 📋 功能特点

- 🎤 **实时录音**：点击麦克风按钮或长按空格键开始录音
- 🔍 **智能识别**：使用科大讯飞ASR技术，识别准确率高
- 🚀 **自动发送**：识别成功后自动发送消息，无需手动点击
- 💬 **可视化反馈**：录音和识别过程有清晰的视觉提示
- 📱 **跨平台支持**：支持PC和移动设备

## 🛠️ 使用方法

### 方式一：点击麦克风按钮

1. 点击输入框右侧的 🎤 按钮
2. 看到录音弹窗后，对着麦克风说话
3. 再次点击麦克风按钮或点击"停止录音"按钮结束录音
4. 等待语音识别完成
5. 识别成功后消息会自动发送

### 方式二：空格键快捷录音

1. 确保输入框未聚焦（点击其他地方）
2. 长按空格键开始录音
3. 松开空格键结束录音
4. 等待识别和自动发送

## 🎨 界面说明

### 录音状态提示

- **准备状态**：🎤 语音输入已就绪
- **录音中**：🔴 正在录音...
- **识别中**：⏳ 正在识别...
- **成功**：✅ 识别成功
- **失败**：❌ 识别失败

### 录音弹窗

录音时会出现全屏弹窗，包含：
- 动画波形显示
- 录音提示文字
- 停止录音按钮

### 识别弹窗

识别时会显示：
- 转圈加载动画
- 识别提示文字

## 🔧 配置说明

### 录音参数

默认录音配置（在 `static/js/chat.js` 中）：

```javascript
const stream = await navigator.mediaDevices.getUserMedia({ 
    audio: {
        sampleRate: 16000,       // 采样率
        channelCount: 1,         // 单声道
        echoCancellation: true,  // 回声消除
        noiseSuppression: true   // 降噪
    }
});
```

### 识别参数

语音识别配置（在 `asr_service.py` 中）：

```python
business_args = {
    "domain": "iat",         # 应用领域
    "language": "zh_cn",     # 语言：中文
    "accent": "mandarin",    # 方言：普通话
    "format": "audio/L16;rate=16000",  # 音频格式
    "encoding": "raw"        # 编码格式
}
```

## 🔍 故障排除

### 常见问题

1. **无法录音**
   - 检查麦克风权限是否授权
   - 确认浏览器支持MediaRecorder API
   - 检查麦克风是否正常工作

2. **识别失败**
   - 确保网络连接正常
   - 检查科大讯飞API配置
   - 尝试重新录音

3. **识别结果不准确**
   - 在安静环境中录音
   - 靠近麦克风说话
   - 说话清楚，语速适中

4. **录音无声音**
   - 检查系统音量设置
   - 确认麦克风未被静音
   - 尝试在其他应用中测试麦克风

### 浏览器兼容性

| 浏览器 | 支持版本 | 备注 |
|--------|---------|------|
| Chrome | 60+ | 推荐使用 |
| Firefox | 55+ | 良好支持 |
| Safari | 14+ | 需要HTTPS |
| Edge | 79+ | 良好支持 |
| IE | ❌ | 不支持 |

### 权限管理

#### 首次使用
1. 浏览器会弹出麦克风权限请求
2. 点击"允许"授权麦克风访问
3. 如果误点"拒绝"，需要手动重新授权

#### 重新授权方法
1. 点击地址栏左侧的锁型图标
2. 将麦克风权限改为"允许"
3. 刷新页面

## 📈 性能优化

### 录音质量优化

- 使用外置麦克风获得更好的录音质量
- 在安静环境中使用
- 保持适当的录音距离（15-30cm）

### 识别准确率提升

- 说话清楚，语速适中
- 避免方言和口音过重
- 避免背景噪音干扰

### 网络优化

- 确保网络连接稳定
- 使用高速网络连接
- 避免网络拥塞时间段

## 🎯 使用技巧

### 录音技巧

1. **环境选择**：选择安静的环境
2. **距离控制**：保持适当距离，不要太近或太远
3. **语速控制**：说话清楚，不要过快或过慢
4. **内容准备**：提前想好要说的内容

### 交互技巧

1. **简洁表达**：尽量用简洁的语言表达
2. **分段录音**：长内容可以分多次录音
3. **确认结果**：识别结果出现后确认准确性
4. **重新录音**：如果识别错误，可以重新录音

## 🔐 隐私保护

- 录音数据仅用于语音识别
- 不会保存录音文件
- 识别结果不会上传到第三方
- 所有数据处理都在本地完成

## 🆕 未来功能

- [ ] 支持多种语言识别
- [ ] 离线语音识别
- [ ] 语音情感分析
- [ ] 语音指令控制
- [ ] 连续对话模式

## 📞 技术支持

如果遇到问题：
1. 查看浏览器控制台错误信息
2. 检查网络连接和API配置
3. 参考故障排除部分
4. 联系技术支持

---

**🎤 现在就试试和黄鹏直接对话吧！谢猪猪，期待听到你的声音！** 